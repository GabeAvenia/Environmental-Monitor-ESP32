@startuml
hide footbox
mainframe **cd** UC4: Fetch Environment Data
skinparam sequenceMessageAlign center

actor "Test Engineer" as Engineer
participant "LabVIEW" as LabVIEW
participant "ESP32" as Board
participant "Peripherals" as Peripherals

alt Single Measurement
  Engineer -> LabVIEW: Select peripherals to read
  Engineer -> LabVIEW: Read Measurements.vi
  
  LabVIEW -> Board: MEAS? [peripheral list]
  Board -> Peripherals: Poll sensors
  Peripherals -> Board: Return readings
  Board -> LabVIEW: Measurement data
  LabVIEW -> Engineer: Show readings

else Continuous Monitoring
  Engineer -> LabVIEW: While loop with Read Measurements.vi
  Engineer -> LabVIEW: Configure polling rate and stop condition
  Engineer -> LabVIEW: Run VI
  
  loop Until stopped
    LabVIEW -> Board: MEAS? [peripheral list]
    Board -> Peripherals: Poll sensors
    Peripherals -> Board: Return readings
    Board -> LabVIEW: Measurement data
    LabVIEW -> LabVIEW: Update display
    LabVIEW -> LabVIEW: Optional: log data
    LabVIEW -> LabVIEW: Wait (delay)
  end
  
  Engineer -> LabVIEW: Stop monitoring
end

@enduml